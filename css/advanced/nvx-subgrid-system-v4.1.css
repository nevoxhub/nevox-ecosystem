/*======================================*/
/*⚡ CSS SUBGRID SYSTEM v4.1 - NEVOX ECOSYSTEM */
/* Enterprise-Grade • Progressive Enhancement • Future-Proof */
/*======================================*/

/*  SUBGRID FEATURE DETECTION & PROGRESSIVE ENHANCEMENT */
@supports (grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid) {
  :root {
    --nvx-subgrid-supported: true;
    --nvx-grid-level: 'level-2';
  }
  
  .nvx-subgrid-enabled {
    /* Visual indicator for development/debug only */
    outline-offset: -1px;
  }
}

@supports not ((grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid)) {
  :root {
    --nvx-subgrid-supported: false;
    --nvx-grid-level: 'level-1';
  }
}

/*  BASE GRID SYSTEM (Universal - Works Everywhere) */
.nvx-grid-system {
  display: grid;
  grid-template-columns: 
    [full-start] minmax(var(--nvx-space-4), 1fr) 
    [main-start] minmax(0, var(--nvx-container-lg)) 
    [main-end] minmax(var(--nvx-space-4), 1fr) 
    [full-end];
  gap: var(--nvx-space-6);
  width: 100%;
}

/* Main content area - universal grid */
.nvx-main-grid {
  grid-column: main-start / main-end;
  display: grid;
  grid-template-columns: repeat(12, 1fr);
  gap: var(--nvx-space-6);
  align-items: start;
}

/*  SUBGRID ENHANCEMENT LAYER (Progressive Enhancement) */
@supports (grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid) {
  
  /* SUBGRID CARD SYSTEM */
  .nvx-subgrid-card-container {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: auto;
    gap: inherit;
    margin: 0;
    padding: 0;
  }
  
  .nvx-subgrid-card {
    grid-column: span 4;
    display: grid;
    grid-template-rows: subgrid;
    grid-template-columns: subgrid;
    background: var(--nvx-bg-card);
    border: 1px solid var(--nvx-border);
    border-radius: var(--nvx-radius-lg);
    overflow: hidden;
    transition: all var(--nvx-duration-medium) var(--nvx-ease-standard);
  }
  
  .nvx-subgrid-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--nvx-shadow-lg);
    border-color: var(--nvx-primary);
  }
  
  /* Card subgrid internal structure */
  .nvx-subgrid-card-header {
    grid-column: 1 / -1;
    grid-row: 1;
    padding: var(--nvx-space-6);
    border-bottom: 1px solid var(--nvx-border);
    background: var(--nvx-bg-tertiary);
  }
  
  .nvx-subgrid-card-body {
    grid-column: 1 / -1;
    grid-row: 2;
    padding: var(--nvx-space-6);
    display: grid;
    grid-template-columns: subgrid;
    gap: var(--nvx-space-4);
  }
  
  .nvx-subgrid-card-footer {
    grid-column: 1 / -1;
    grid-row: 3;
    padding: var(--nvx-space-6);
    border-top: 1px solid var(--nvx-border);
    background: var(--nvx-bg-secondary);
    display: grid;
    grid-template-columns: subgrid;
    align-items: center;
  }
  
  /* SUBGRID DASHBOARD LAYOUT */
  .nvx-subgrid-dashboard {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr;
    grid-template-rows: auto 1fr auto;
    gap: var(--nvx-space-6);
    min-height: 600px;
  }
  
  .nvx-subgrid-dashboard-widget {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
    background: var(--nvx-bg-card);
    border: 1px solid var(--nvx-border);
    border-radius: var(--nvx-radius-lg);
    padding: var(--nvx-space-6);
  }
  
  .nvx-subgrid-dashboard-main {
    grid-column: 2;
    grid-row: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
  }
  
  /* SUBGRID EDITORIAL LAYOUT */
  .nvx-subgrid-editorial {
    display: grid;
    grid-template-columns: 2fr 1fr;
    grid-template-rows: auto 1fr auto;
    gap: var(--nvx-space-8);
  }
  
  .nvx-subgrid-article {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
    gap: inherit;
  }
  
  .nvx-subgrid-article-header {
    grid-column: 1 / -1;
    grid-row: 1;
    margin-bottom: var(--nvx-space-8);
  }
  
  .nvx-subgrid-article-content {
    grid-column: 1;
    grid-row: 2;
    display: grid;
    grid-template-columns: subgrid;
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-article-sidebar {
    grid-column: 2;
    grid-row: 2;
    display: grid;
    grid-template-rows: subgrid;
    gap: var(--nvx-space-6);
  }
  
  /* SUBGRID FORM LAYOUT */
  .nvx-subgrid-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-form-group {
    display: grid;
    grid-template-columns: subgrid;
    grid-column: span 2;
    gap: var(--nvx-space-4);
  }
  
  .nvx-subgrid-form-label {
    grid-column: 1;
    align-self: center;
  }
  
  .nvx-subgrid-form-input {
    grid-column: 2;
  }
  
  .nvx-subgrid-form-full {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
  }
  
  /* SUBGRID PRODUCT GRID */
  .nvx-subgrid-product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-product-card {
    display: grid;
    grid-template-rows: subgrid;
    grid-template-columns: subgrid;
    gap: inherit;
  }
  
  .nvx-subgrid-product-image {
    grid-column: 1 / -1;
    grid-row: 1;
    aspect-ratio: 1 / 1;
    overflow: hidden;
  }
  
  .nvx-subgrid-product-info {
    grid-column: 1 / -1;
    grid-row: 2;
    display: grid;
    grid-template-columns: subgrid;
    padding: var(--nvx-space-4);
  }
  
  /* SUBGRID RESPONSIVE UTILITIES */
  .nvx-subgrid-responsive {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-responsive-item {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
  }
  
  /* SUBGRID ACCESSIBILITY ENHANCEMENTS */
  .nvx-subgrid-focus-order:focus-visible {
    outline: 3px solid var(--nvx-primary);
    outline-offset: 2px;
    z-index: var(--nvx-z-base);
  }
  
  /* SUBGRID PERFORMANCE OPTIMIZATION */
  .nvx-subgrid-contain {
    contain: layout style paint;
    will-change: transform;
  }
  
  /* SUBGRID ALIGNMENT UTILITIES */
  .nvx-subgrid-align-start {
    align-self: start;
    justify-self: start;
  }
  
  .nvx-subgrid-align-center {
    align-self: center;
    justify-self: center;
  }
  
  .nvx-subgrid-align-end {
    align-self: end;
    justify-self: end;
  }
  
  .nvx-subgrid-align-stretch {
    align-self: stretch;
    justify-self: stretch;
  }
  
  /* SUBGRID SPAN UTILITIES */
  .nvx-subgrid-span-full {
    grid-column: 1 / -1;
  }
  
  .nvx-subgrid-span-half {
    grid-column: span 6;
  }
  
  .nvx-subgrid-span-third {
    grid-column: span 4;
  }
  
  .nvx-subgrid-span-quarter {
    grid-column: span 3;
  }
  
  /* DARK THEME SUBGRID ENHANCEMENTS */
  [data-theme="dark"] .nvx-subgrid-card {
    background: var(--nvx-bg-card);
    border-color: var(--nvx-color-border-main);
  }
  
  [data-theme="dark"] .nvx-subgrid-card:hover {
    border-color: var(--nvx-primary-400);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }
}

/*  FALLBACK SYSTEM (For Non-Subgrid Browsers) */
@supports not ((grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid)) {
  
  /* CARD FALLBACK - Same visual result, different implementation */
  .nvx-subgrid-card-container {
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    gap: var(--nvx-space-6);
    margin: 0;
    padding: 0;
  }
  
  .nvx-subgrid-card {
    grid-column: span 4;
    display: flex;
    flex-direction: column;
    background: var(--nvx-bg-card);
    border: 1px solid var(--nvx-border);
    border-radius: var(--nvx-radius-lg);
    overflow: hidden;
    transition: all var(--nvx-duration-medium) var(--nvx-ease-standard);
  }
  
  .nvx-subgrid-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--nvx-shadow-lg);
    border-color: var(--nvx-primary);
  }
  
  .nvx-subgrid-card-header {
    padding: var(--nvx-space-6);
    border-bottom: 1px solid var(--nvx-border);
    background: var(--nvx-bg-tertiary);
    width: 100%;
  }
  
  .nvx-subgrid-card-body {
    padding: var(--nvx-space-6);
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--nvx-space-4);
  }
  
  .nvx-subgrid-card-footer {
    padding: var(--nvx-space-6);
    border-top: 1px solid var(--nvx-border);
    background: var(--nvx-bg-secondary);
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  /* DASHBOARD FALLBACK */
  .nvx-subgrid-dashboard {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr;
    grid-template-rows: auto 1fr auto;
    gap: var(--nvx-space-6);
    min-height: 600px;
  }
  
  .nvx-subgrid-dashboard-widget {
    background: var(--nvx-bg-card);
    border: 1px solid var(--nvx-border);
    border-radius: var(--nvx-radius-lg);
    padding: var(--nvx-space-6);
  }
  
  /* EDITORIAL FALLBACK */
  .nvx-subgrid-editorial {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: var(--nvx-space-8);
  }
  
  .nvx-subgrid-article {
    display: flex;
    flex-direction: column;
    gap: var(--nvx-space-8);
  }
  
  /* FORM FALLBACK */
  .nvx-subgrid-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-form-group {
    grid-column: span 2;
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: var(--nvx-space-4);
    align-items: center;
  }
  
  .nvx-subgrid-form-full {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    gap: var(--nvx-space-4);
  }
  
  /* PRODUCT GRID FALLBACK */
  .nvx-subgrid-product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--nvx-space-6);
  }
  
  .nvx-subgrid-product-card {
    display: flex;
    flex-direction: column;
    gap: var(--nvx-space-4);
  }
}

/*  RESPONSIVE ADAPTATIONS FOR SUBGRID */
@media (max-width: 1200px) {
  .nvx-main-grid {
    grid-template-columns: repeat(10, 1fr);
    gap: var(--nvx-space-5);
  }
  
  .nvx-subgrid-card {
    grid-column: span 5;
  }
  
  .nvx-subgrid-dashboard {
    grid-template-columns: 1fr;
    grid-template-rows: repeat(auto-fit, minmax(200px, auto));
  }
  
  .nvx-subgrid-dashboard-main {
    grid-column: 1;
    grid-row: auto;
  }
  
  @supports not ((grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid)) {
    .nvx-subgrid-card {
      grid-column: span 5;
    }
  }
}

@media (max-width: 768px) {
  .nvx-main-grid {
    grid-template-columns: repeat(6, 1fr);
    gap: var(--nvx-space-4);
  }
  
  .nvx-subgrid-card {
    grid-column: span 6;
  }
  
  .nvx-subgrid-editorial {
    grid-template-columns: 1fr;
  }
  
  .nvx-subgrid-form {
    grid-template-columns: 1fr;
  }
  
  .nvx-subgrid-form-group {
    grid-template-columns: 1fr;
    gap: var(--nvx-space-2);
  }
  
  .nvx-subgrid-form-label,
  .nvx-subgrid-form-input {
    grid-column: 1;
  }
  
  @supports not ((grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid)) {
    .nvx-subgrid-card {
      grid-column: span 6;
    }
    
    .nvx-subgrid-form-group {
      grid-template-columns: 1fr;
    }
  }
}

@media (max-width: 480px) {
  .nvx-main-grid {
    grid-template-columns: repeat(4, 1fr);
    gap: var(--nvx-space-3);
  }
  
  .nvx-subgrid-card {
    grid-column: span 4;
  }
  
  @supports not ((grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid)) {
    .nvx-subgrid-card {
      grid-column: span 4;
    }
  }
}

/*  REDUCED MOTION SUPPORT */
@media (prefers-reduced-motion: reduce) {
  .nvx-subgrid-card,
  .nvx-subgrid-card:hover {
    transition: none;
    transform: none;
  }
}

/*  HIGH CONTRAST MODE */
@media (prefers-contrast: high) {
  .nvx-subgrid-card {
    border: 2px solid currentColor;
  }
  
  .nvx-subgrid-card-header,
  .nvx-subgrid-card-footer {
    border: 1px solid currentColor;
  }
}

/*  PRINT OPTIMIZATION */
@media print {
  .nvx-subgrid-card {
    break-inside: avoid;
    border: 1px solid #000;
    box-shadow: none;
  }
  
  .nvx-subgrid-card:hover {
    transform: none;
    box-shadow: none;
  }
}

/*  PERFORMANCE OPTIMIZATIONS */
.nvx-subgrid-optimized {
  content-visibility: auto;
  contain-intrinsic-size: 0 500px;
}

.nvx-subgrid-will-change {
  will-change: transform;
  backface-visibility: hidden;
}

/*  DEBUG UTILITIES (Development Only - Remove in Production) */
.nvx-subgrid-debug * {
  outline: 1px solid rgba(59, 130, 246, 0.3);
}

.nvx-subgrid-debug-grid {
  background-image: 
    linear-gradient(rgba(59, 130, 246, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(59, 130, 246, 0.1) 1px, transparent 1px);
  background-size: var(--nvx-space-6) var(--nvx-space-6);
}

/*  BROWSER-SPECIFIC FIXES */
/* Firefox Subgrid Optimizations */
@-moz-document url-prefix() {
  @supports (grid-template-columns: subgrid) {
    .nvx-subgrid-card {
      -moz-transform: translateZ(0);
    }
  }
}

/* Safari Subgrid Workarounds */
@supports (grid-template-columns: subgrid) and (not (-moz-transform: translateZ(0))) {
  .nvx-subgrid-card {
    -webkit-transform: translateZ(0);
  }
}

/*  SUBGRID TOKEN INTEGRATION */
:root {
  /* Subgrid-specific spacing tokens */
  --nvx-subgrid-gap-sm: var(--nvx-space-4);
  --nvx-subgrid-gap-md: var(--nvx-space-6);
  --nvx-subgrid-gap-lg: var(--nvx-space-8);
  
  /* Subgrid column counts */
  --nvx-subgrid-cols-sm: 4;
  --nvx-subgrid-cols-md: 8;
  --nvx-subgrid-cols-lg: 12;
  --nvx-subgrid-cols-xl: 16;
  
  /* Subgrid z-index layering */
  --nvx-z-subgrid-base: 10;
  --nvx-z-subgrid-content: 20;
  --nvx-z-subgrid-overlay: 30;
}

/*  SUBGRID COMPONENT EXAMPLES */
/* Example 1: Pricing Table with Subgrid */
.nvx-subgrid-pricing {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--nvx-space-8);
  align-items: stretch;
}

@supports (grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid) {
  .nvx-subgrid-pricing-tier {
    display: grid;
    grid-template-rows: subgrid;
    grid-template-columns: subgrid;
    gap: inherit;
  }
  
  .nvx-subgrid-pricing-header {
    grid-row: 1;
    grid-column: 1 / -1;
  }
  
  .nvx-subgrid-pricing-features {
    grid-row: 2;
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
  }
  
  .nvx-subgrid-pricing-footer {
    grid-row: 3;
    grid-column: 1 / -1;
    align-self: end;
  }
}

/* Example 2: Team Grid with Subgrid */
.nvx-subgrid-team {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--nvx-space-8);
}

@supports (grid-template-columns: subgrid) or (-moz-grid-template-columns: subgrid) {
  .nvx-subgrid-team-member {
    display: grid;
    grid-template-rows: subgrid;
    grid-template-columns: subgrid;
    text-align: center;
  }
  
  .nvx-subgrid-team-avatar {
    grid-row: 1;
    grid-column: 1 / -1;
    justify-self: center;
  }
  
  .nvx-subgrid-team-info {
    grid-row: 2;
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
  }
  
  .nvx-subgrid-team-social {
    grid-row: 3;
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: subgrid;
    justify-content: center;
  }
}

/*  SUBGRID UTILITY CLASSES */
.nvx-grid-subgrid {
  display: grid;
  grid-template-columns: subgrid;
  grid-template-rows: subgrid;
}

.nvx-grid-subgrid-cols {
  grid-template-columns: subgrid;
}

.nvx-grid-subgrid-rows {
  grid-template-rows: subgrid;
}

.nvx-subgrid-align-tracks {
  align-content: start;
  justify-content: start;
}

.nvx-subgrid-auto-density {
  grid-auto-flow: dense;
}

/*  VERSION INFO & METADATA */
/* 
  NEVOX SUBGRID SYSTEM v4.1.0
  Status: Production Ready
  Standards: CSS Grid Level 2 Compliant
  Browser Support: Progressive Enhancement
  Fallback: 100% Compatible
  Performance: Optimized
  Accessibility: WCAG 2.2 Compliant
  Last Updated: 2026
*/

/*======================================*/
/* END OF CSS SUBGRID SYSTEM v4.1 */
/*======================================*/
